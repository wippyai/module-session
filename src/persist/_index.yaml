version: "1.0"
namespace: wippy.session.persist

entries:
  # wippy.session.persist:writer
  - name: writer
    kind: library.lua
    meta:
      comment: Session writer for secure write operations on sessions, messages, artifacts, and contexts
    source: file://writer.lua
    modules:
      - uuid
      - json
      - security
    imports:
      session_repo: wippy.session.persist:session_repo
      message_repo: wippy.session.persist:message_repo
      artifact_repo: wippy.session.persist:artifact_repo
      context_repo: wippy.session.persist:context_repo
      session_contexts_repo: wippy.session.persist:session_contexts_repo

  # wippy.session.persist:artifact_repo
  - name: artifact_repo
    kind: library.lua
    meta:
      comment: Artifact repository for managing session artifacts
    source: file://artifact_repo.lua
    modules:
      - sql
      - json
      - security
      - time
    imports:
      consts: wippy.session:consts

  # wippy.session.persist:artifact_repo_test
  - name: artifact_repo_test
    kind: function.lua
    meta:
      type: test
      suite: session
      comment: Tests the artifact repository functionality
    source: file://artifact_repo_test.lua
    modules:
      - sql
      - uuid
      - json
      - time
      - security
    imports:
      artifact_repo: wippy.session.persist:artifact_repo
      context_repo: wippy.session.persist:context_repo
      session_repo: wippy.session.persist:session_repo
      test: wippy.test:test
      consts: wippy.session:consts
    method: run

  # wippy.session.persist:context_repo
  - name: context_repo
    kind: library.lua
    meta:
      comment: Context repository for managing data and text contexts
    source: file://context_repo.lua
    modules:
      - sql
      - time
    imports:
      consts: wippy.session:consts

  # wippy.session.persist:context_repo_test
  - name: context_repo_test
    kind: function.lua
    meta:
      type: test
      suite: session
      comment: Tests the context repository functionality
    source: file://context_repo_test.lua
    modules:
      - sql
      - uuid
      - time
      - security
    imports:
      context_repo: wippy.session.persist:context_repo
      test: wippy.test:test
      consts: wippy.session:consts
    method: run

  # wippy.session.persist:message_repo
  - name: message_repo
    kind: library.lua
    meta:
      comment: Message repository for managing session messages
    source: file://message_repo.lua
    modules:
      - sql
      - json
      - time
    imports:
      consts: wippy.session:consts

  # wippy.session.persist:message_repo_test
  - name: message_repo_test
    kind: function.lua
    meta:
      type: test
      suite: session
      comment: Tests the message repository functionality
    source: file://message_repo_test.lua
    modules:
      - sql
      - uuid
      - json
      - time
      - security
    imports:
      context_repo: wippy.session.persist:context_repo
      message_repo: wippy.session.persist:message_repo
      session_repo: wippy.session.persist:session_repo
      test: wippy.test:test
      consts: wippy.session:consts
    method: run

  # wippy.session.persist:session_contexts_repo
  - name: session_contexts_repo
    kind: library.lua
    meta:
      comment: Session contexts repository for managing additional session data
    source: file://session_contexts_repo.lua
    modules:
      - sql
      - json
      - time
    imports:
      consts: wippy.session:consts

  # wippy.session.persist:session_contexts_repo_test
  - name: session_contexts_repo_test
    kind: function.lua
    meta:
      type: test
      suite: session
      comment: Tests the session contexts repository functionality
    source: file://session_contexts_repo_test.lua
    modules:
      - sql
      - uuid
      - time
      - security
    imports:
      context_repo: wippy.session.persist:context_repo
      session_contexts_repo: wippy.session.persist:session_contexts_repo
      session_repo: wippy.session.persist:session_repo
      test: wippy.test:test
      consts: wippy.session:consts
    method: run

  # wippy.session.persist:session_repo
  - name: session_repo
    kind: library.lua
    meta:
      comment: Session repository for managing user sessions
    source: file://session_repo.lua
    modules:
      - sql
      - json
      - time
    imports:
      consts: wippy.session:consts

  # wippy.session.persist:session_repo_test
  - name: session_repo_test
    kind: function.lua
    meta:
      type: test
      suite: session
      comment: Tests the session repository functionality
    source: file://session_repo_test.lua
    modules:
      - sql
      - uuid
      - time
      - security
    imports:
      context_repo: wippy.session.persist:context_repo
      session_repo: wippy.session.persist:session_repo
      test: wippy.test:test
      consts: wippy.session:consts
    method: run

  # wippy.session.persist:reader
  - name: reader
    kind: library.lua
    meta:
      comment: Session reader with fluent query interface for messages, artifacts, and contexts
    source: file://reader.lua
    modules:
      - security
      - json
    imports:
      consts: wippy.session:consts
      session_repo: wippy.session.persist:session_repo
      message_repo: wippy.session.persist:message_repo
      artifact_repo: wippy.session.persist:artifact_repo
      session_contexts_repo: wippy.session.persist:session_contexts_repo
      context_repo: wippy.session.persist:context_repo
